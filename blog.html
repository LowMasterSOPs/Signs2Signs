<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blog | Signs2Signs</title>
  <link rel="icon" type="image/svg+xml" href="public/S2S.svg" />
  <style>
    :root{--bg:#0A0F1C;--brand:#0B1B4A;--card:rgba(255,255,255,.06);--stroke:rgba(255,255,255,.12)}
    *{box-sizing:border-box}
    body{margin:0;color:#f8fafc;background:linear-gradient(180deg,var(--brand),var(--bg));font-family:Manrope,system-ui,Segoe UI,Roboto,Arial,sans-serif}
    .container{max-width:1100px;margin:0 auto;padding:32px 20px}
    h1{margin:0 0 20px;font-size:clamp(28px,5vw,44px)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px}
    .card{display:block;text-decoration:none;color:inherit;background:var(--card);border:1px solid var(--stroke);border-radius:14px;overflow:hidden}
    .thumb{width:100%;aspect-ratio:16/9;object-fit:cover;background:#0b0b0b}
    .title{margin:14px 14px 6px;font-weight:700}
    .desc{margin:0 14px 16px;color:#cbd5e1}
    .empty{opacity:.8}
  </style>
</head>
<body>
  <!-- Header include -->
  <div id="header"></div>

  <main class="container">
    <h1>Blog</h1>
    <div id="posts" class="grid" aria-live="polite">Loading…</div>
  </main>

  <!-- Footer include -->
  <div id="footer"></div>

  <script type="module">
    import { fetchPosts, includePartials } from "./blog.js"

    const postsEl = document.getElementById("posts")

    async function render() {
      postsEl.textContent = "Loading…"
      const { data, error } = await fetchPosts()
      if (error) { console.error(error); postsEl.textContent = "Error loading posts."; return }

      if (!data || data.length === 0) {
        postsEl.innerHTML = `<p class="empty">No posts yet.</p>`
        return
      }

      postsEl.innerHTML = ""
      for (const p of data) {
        const a = document.createElement("a")
        a.className = "card"
        a.href = `post.html?slug=${encodeURIComponent(p.slug || p.id)}`
        a.innerHTML = `
          ${p.main_image_url ? `<img class="thumb" src="${p.main_image_url}" alt="">` : ""}
          <div class="title">${p.title ?? "Untitled"}</div>
          ${p.description ? `<p class="desc">${p.description}</p>` : ""}
        `
        postsEl.appendChild(a)
      }
    }

    // load header/footer and posts
    includePartials()
    render()
  </script>
</body>
</html>
